#!/usr/bin/expect



proc inc3_11_5 {} {
	global user_name exit_code res_name


	# TEST 5
	# Test node reservation conflict
	#
	send_user "\n+++++ STARTING TEST 5 +++++\n"
	# Make the reservation
	set ret_code [create_res "StartTime=now+60minutes Duration=60 Nodes=ALL user=$user_name" 0]
	if {$ret_code != 0} {
		send_user "\nFAILURE: Unable to create a valid reservation\n"
		exit $ret_code
	}

	set res_name_save $res_name

	# Test for node reservation conflict
	set ret_code [create_res "StartTime=now+60minutes Duration=60 NodeCnt=1 user=$user_name" 1]
	if {$ret_code == 0} {
		send_user "\nFAILURE: Reservation $test did not fail but should have\n"
		delete_res $res_name
		exit 1
	} else {
		send_user "Expected error.  You can turn that frown upside-down.\n"
	}

	# Delete the reservation
	set ret_code [delete_res $res_name_save]
	if {$ret_code != 0} {
		exit $ret_code
	}
}
